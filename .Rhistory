plot(all_rich_dist_df[,2]~all_rich_dist_df[,1],
col = as.character(all_rich_dist_df[,3]), pch = 17,
ylab = "Allelic Richness", xlab = "Distance to Range Edge (km)",
cex = (butternut_24pop_poppr[1:24,2]/50), ylim = c(5,10), xlim = c(0,600),
main = "Allelic Richness Compared with Distance to Range Edge (km)")
text(all_rich_dist_df[,2]~all_rich_dist_df[,1],
labels = rownames(all_rich_dist_df), cex = 0.8, pos = 1)
abline(allrich_lm, col = "dodgerblue4", lwd = 1)
abline(allrich_red_lm, col = "darkorchid", lwd = 1)
##legends
legend('topleft', legend = linear_allrich_dist_rp, pch = 17, col = "dodgerblue4",
title = "Regression with WI",
bty = 'n', border = "black", pt.cex = 1, cex = 0.8)
legend('bottomleft', legend = linear_allrich_dist_red_rp, pch = 17,
col = "darkorchid", title = "Regression without WI",
bty = 'n', border = "black", pt.cex = 1, cex = 0.8)
legend('bottom', legend = c("New Brunswick", "Ontario", "Quebec", "United States"), pch = 17,
col = c("firebrick1", "firebrick4", "lightsalmon", "dodgerblue"))
##Allelic Richness Distance
pdf("genetic_analyses_results\\linear_allrich_dist_edge.pdf", width = 8, height = 6)
plot(all_rich_dist_df[,2]~all_rich_dist_df[,1],
col = as.character(all_rich_dist_df[,3]), pch = 17,
ylab = "Allelic Richness", xlab = "Distance to Range Edge (km)",
cex = (butternut_24pop_poppr[1:24,2]/50), ylim = c(5,10), xlim = c(0,600),
main = "Allelic Richness Compared with Distance to Range Edge (km)")
text(all_rich_dist_df[,2]~all_rich_dist_df[,1],
labels = rownames(all_rich_dist_df), cex = 0.8, pos = 1)
abline(allrich_lm, col = "dodgerblue4", lwd = 1)
abline(allrich_red_lm, col = "darkorchid", lwd = 1)
##legends
legend('topleft', legend = linear_allrich_dist_rp, pch = 17, col = "dodgerblue4",
title = "Regression with WI",
bty = 'n', border = "black", pt.cex = 1, cex = 0.8)
legend('bottomleft', legend = linear_allrich_dist_red_rp, pch = 17,
col = "darkorchid", title = "Regression without WI",
bty = 'n', border = "black", pt.cex = 1, cex = 0.8)
legend('bottom', legend = c("New Brunswick", "Ontario", "Quebec", "United States"), pch = 17,
col = c("firebrick1", "firebrick4", "lightsalmon", "dodgerblue"))
dev.off()
plot(hexp_dist_edge_df[,2]~hexp_dist_edge_df[,1],
col = as.character(hexp_dist_edge_df[,3]), pch = 17, ylim = c(0.74,0.86),
ylab = "Expected Heterozygosity", xlab = "Distance to Range Edge (km)",
cex = (butternut_24pop_poppr[1:24,2]/50), xlim = c(0,600),
main = "Expected Heterozygosity Compared with Distance to Range Edge (km)")
hexp_dist_edge_df[,3]
hexp_dist_edge_df
hexp_dist_edge_df[,6]
hexp_dist_edge_df
dist_edge_df
######################################################################
##################### Create hexp data frame  ########################
######################################################################
##create hexp df by combining distance to edge, hexp, and color for each pop
hexp_dist_edge_df <- data.frame(dist_edge_df$Dist_To_Edge, as.numeric(butternut_24pop_poppr[1:24,10]), dist_edge_df$Col)
##name rows and columns
colnames(hexp_dist_edge_df) <- c("Distance", "HExp", "Col")
rownames(hexp_dist_edge_df) <- butternut_24pop_names
##remove wisconsin populations
hexp_dist_edge_red <- hexp_dist_edge_df[-c(16,22,23),]
###now calculate regressions - linear
hexp_dist_lm <- lm(hexp_dist_edge_df[,2]~hexp_dist_edge_df[,1])
hexp_dist_lm_sum <- summary(hexp_dist_lm)
##linear regression without
hexp_dist_edge_red_lm <- lm(hexp_dist_edge_red[,2]~hexp_dist_edge_red[,1])
hexp_dist_edge_red_lm_sum <- summary(hexp_dist_edge_red_lm)
##create r2 and p for full df
hexp_dist_r2 <- hexp_dist_lm_sum$adj.r.squared
hexp_dist_coef <- hexp_dist_lm_sum$coefficients
hexp_dist_pvalue <- hexp_dist_coef[2,4]
hexp_dist_rp <- vector('expression',2)
hexp_dist_rp[1] <- substitute(expression(italic(R)^2 == MYVALUE),
list(MYVALUE = format(hexp_dist_r2,dig=3)))[2]
hexp_dist_rp[2] <- substitute(expression(italic(p) == MYOTHERVALUE),
list(MYOTHERVALUE = format(hexp_dist_pvalue, digits = 2)))[2]
##create r2 and p for reduced df - without Wisconsin populations
hexp_red_dist_r2 <- hexp_dist_edge_red_lm_sum$adj.r.squared
hexp_red_dist_coef <- hexp_dist_edge_red_lm_sum$coefficients
hexp_red_dist_pvalue <- hexp_red_dist_coef[2,4]
hexp_red_dist_rp <- vector('expression',2)
hexp_red_dist_rp[1] <- substitute(expression(italic(R)^2 == MYVALUE),
list(MYVALUE = format(hexp_red_dist_r2,dig=3)))[2]
hexp_red_dist_rp[2] <- substitute(expression(italic(p) == MYOTHERVALUE),
list(MYOTHERVALUE = format(hexp_red_dist_pvalue, digits = 2)))[2]
plot(hexp_dist_edge_df[,2]~hexp_dist_edge_df[,1],
col = as.character(hexp_dist_edge_df[,3]), pch = 17, ylim = c(0.74,0.86),
ylab = "Expected Heterozygosity", xlab = "Distance to Range Edge (km)",
cex = (butternut_24pop_poppr[1:24,2]/50), xlim = c(0,600),
main = "Expected Heterozygosity Compared with Distance to Range Edge (km)")
text(hexp_dist_df[,2]~hexp_dist_df[,1],
labels = butternut_24pop_names, cex = 0.8, pos = 1)
text(hexp_dist_edge_df[,2]~hexp_dist_edge_df[,1],
labels = butternut_24pop_names, cex = 0.8, pos = 1)
abline(hexp_dist_lm, col = "dodgerblue4")
abline(hexp_wo_wi_lm, col = "darkorchid")
abline(hexp_dist_edge_red_lm, col = "darkorchid")
##legends
legend('topleft', legend = hexp_dist_rp, pch = 17, col = "dodgerblue4",
title = "Regression with WI",
bty = 'n', border = "black", pt.cex = 1, cex = 0.8)
legend('bottomleft', legend = hexp_red_dist_rp, pch = 17,
col = "darkorchid", title = "Regression without WI",
bty = 'n', border = "black", pt.cex = 1, cex = 0.8)
legend('bottomright', legend = c("New Brunswick", "Ontario", "Quebec", "United States"),
pch = 17, col = c("firebrick1", "firebrick4", "lightsalmon","dodgerblue"))
##################################################################
######################## Plotting Models  ########################
##################################################################
##HExp linear model
pdf("genetic_analyses_results\\hexp_dist.pdf", width = 8, height = 6)
plot(hexp_dist_edge_df[,2]~hexp_dist_edge_df[,1],
col = as.character(hexp_dist_edge_df[,3]), pch = 17, ylim = c(0.74,0.86),
ylab = "Expected Heterozygosity", xlab = "Distance to Range Edge (km)",
cex = (butternut_24pop_poppr[1:24,2]/50), xlim = c(0,600),
main = "Expected Heterozygosity Compared with Distance to Range Edge (km)")
text(hexp_dist_edge_df[,2]~hexp_dist_edge_df[,1],
labels = butternut_24pop_names, cex = 0.8, pos = 1)
abline(hexp_dist_lm, col = "dodgerblue4")
abline(hexp_dist_edge_red_lm, col = "darkorchid")
##legends
legend('topleft', legend = hexp_dist_rp, pch = 17, col = "dodgerblue4",
title = "Regression with WI",
bty = 'n', border = "black", pt.cex = 1, cex = 0.8)
legend('bottomleft', legend = hexp_red_dist_rp, pch = 17,
col = "darkorchid", title = "Regression without WI",
bty = 'n', border = "black", pt.cex = 1, cex = 0.8)
legend('bottomright', legend = c("New Brunswick", "Ontario", "Quebec", "United States"),
pch = 17, col = c("firebrick1", "firebrick4", "lightsalmon","dodgerblue"))
dev.off()
##create data frame of pvalues r2 for linear and quad models
dist_edge_hexp_df <- matrix(nrow = 2, ncol = 2)
rownames(dist_edge_hexp_df) <- c("linear_hexp_withWI","linear_hexp_withoutWI")
colnames(dist_edge_hexp_df) <- c("Pvalue","R2")
##write values
dist_edge_hexp_df[1,] <- c(hexp_dist_pvalue, hexp_dist_r2)
dist_edge_hexp_df[2,] <- c(hexp_red_dist_pvalue, hexp_red_dist_r2)
##write out
write.csv(dist_edge_hexp_df, "genetic_analyses_results\\hexp_dist_pvalue_r2.csv")
##write out data frame with distance to edge and hexp
write.csv(hexp_dist_edge_df, "genetic_analyses_results\\hexp_dist_edge_df.csv")
##############################################################
#################### Load Genetic Files  #####################
##############################################################
##set working directory
setwd(butternut_drive)
#####################################
############ Directories ############
#####################################
butternut_drive <- "C:\\Users\\eschumacher\\Documents\\GitHub\\butternut"
##############################################################
#################### Load Genetic Files  #####################
##############################################################
##set working directory
setwd(butternut_drive)
allrich_dist_edge_df <- read.csv("genetic_analyses_results\\allrich_dist_edge_df.csv")
##############################################################################
######## Run Analyses and Create DF of Just Ontario Quebec and US  ###########
##############################################################################
##remove New Brunswick and create DFs
all_rich_dist_df_wo_NB <- allrich_dist_edge_df[-c(1:6),]
##without wisconsin populations
all_rich_dist_df_wo_NB_red <- all_rich_dist_df_wo_NB[-c(10,16:17),]
######################################################################
########################## Linear Models  ############################
######################################################################
###now calculate regressions - linear
allrich_wo_NB_lm <- lm(all_rich_dist_df_wo_NB[,2]~all_rich_dist_df_wo_NB[,1])
allrich_wo_NB_lm_sum <- summary(allrich_wo_NB_lm)
##Reduced data frame
allrich_red_lm <- lm(all_rich_dist_df_wo_NB_red[,2]~all_rich_dist_df_wo_NB_red[,1])
allrich_red_lm_sum <- summary(allrich_red_lm)
##create r2 and p for full df
linear_allrich_dist_wo_NB_r2 <- allrich_wo_NB_lm_sum$adj.r.squared
linear_allrich_dist_wo_NB_coef <- allrich_wo_NB_lm_sum$coefficients
linear_allrich_dist_wo_NB_pvalue <- linear_allrich_dist_wo_NB_coef[2,4]
linear_allrich_dist_wo_NB_rp <- vector('expression',2)
linear_allrich_dist_wo_NB_rp[1] <- substitute(expression(italic(R)^2 == MYVALUE),
list(MYVALUE = format(linear_allrich_dist_wo_NB_r2,dig=3)))[2]
linear_allrich_dist_wo_NB_rp[2] <- substitute(expression(italic(p) == MYOTHERVALUE),
list(MYOTHERVALUE = format(linear_allrich_dist_wo_NB_pvalue, digits = 2)))[2]
##create r2 and p for reduced df
linear_allrich_dist_wo_NB_red_r2 <- allrich_red_lm_sum$adj.r.squared
linear_allrich_dist_wo_NB_red_coef <- allrich_red_lm_sum$coefficients
linear_allrich_dist_wo_NB_red_pvalue <- linear_allrich_dist_wo_NB_red_coef[2,4]
linear_allrich_dist_wo_NB_red_rp <- vector('expression',2)
linear_allrich_dist_wo_NB_red_rp[1] <- substitute(expression(italic(R)^2 == MYVALUE),
list(MYVALUE = format(linear_allrich_dist_wo_NB_red_r2,dig=3)))[2]
linear_allrich_dist_wo_NB_red_rp[2] <- substitute(expression(italic(p) == MYOTHERVALUE),
list(MYOTHERVALUE = format(linear_allrich_dist_wo_NB_red_pvalue, digits = 2)))[2]
plot(all_rich_dist_df[,2]~all_rich_dist_df[,1],
col = as.character(all_rich_dist_df[,3]), pch = 17,
ylab = "Number of Alleles", xlab = "Distance to Range Edge (km)",
cex = (butternut_24pop_poppr[7:24,2]/80), ylim = c(5,10), xlim = c(0,600),
main = "Number of Alleles Compared with Distance to Range Edge (km)")
plot(all_rich_dist_df_wo_NB[,2]~all_rich_dist_df_wo_NB[,1],
col = as.character(all_rich_dist_df_wo_NB[,3]), pch = 17,
ylab = "Allelic Richness", xlab = "Distance to Range Edge (km)",
cex = (butternut_24pop_poppr[7:24,2]/80), ylim = c(5,10), xlim = c(0,600),
main = "Allelic Richness Compared with Distance to Range Edge (km)")
library(poppr)
library(adegenet)
##generate a poppr document
butternut_poppr <- poppr(butternutgen_reorg)
##load current working reorganized genepop file
butternutgen_reorg <- read.genepop("data_files\\after_reorg\\reorg_gen_24pop.gen", ncode = 3)
##generate a poppr document
butternut_poppr <- poppr(butternutgen_reorg)
##load relatedness file to name individuals
reorg_relatedness <- read.csv("data_files\\after_reorg\\reorg_relatedness.csv")
###Name the reorg file
rownames(butternutgen_reorg@tab) <- reorg_relatedness$Ind
##create population name file
butternut_24pop_names <- unique(reorg_relatedness$Pop)
##Name levels
levels(butternutgen_reorg@pop) <- butternut_24pop_names
##generate a poppr document
butternut_poppr <- poppr(butternutgen_reorg)
plot(all_rich_dist_df_wo_NB[,2]~all_rich_dist_df_wo_NB[,1],
col = as.character(all_rich_dist_df_wo_NB[,3]), pch = 17,
ylab = "Allelic Richness", xlab = "Distance to Range Edge (km)",
cex = (butternut_24pop_poppr[7:24,2]/80), ylim = c(5,10), xlim = c(0,600),
main = "Allelic Richness Compared with Distance to Range Edge (km)")
##generate a poppr document
butternut_24pop_poppr <- poppr(butternutgen_reorg)
plot(all_rich_dist_df_wo_NB[,2]~all_rich_dist_df_wo_NB[,1],
col = as.character(all_rich_dist_df_wo_NB[,3]), pch = 17,
ylab = "Allelic Richness", xlab = "Distance to Range Edge (km)",
cex = (butternut_24pop_poppr[7:24,2]/80), ylim = c(5,10), xlim = c(0,600),
main = "Allelic Richness Compared with Distance to Range Edge (km)")
all_rich_dist_df_wo_NB
all_rich_dist_df_wo_NB[,3]
plot(all_rich_dist_df_wo_NB[,3]~all_rich_dist_df_wo_NB[,2],
col = as.character(all_rich_dist_df_wo_NB[,4]), pch = 17,
ylab = "Allelic Richness", xlab = "Distance to Range Edge (km)",
cex = (butternut_24pop_poppr[7:24,2]/50), ylim = c(5,10), xlim = c(0,600),
main = "Allelic Richness Compared with Distance to Range Edge (km)")
all_rich_dist_df_wo_NB_red
######################################################################
########################## Linear Models  ############################
######################################################################
###now calculate regressions - linear
allrich_wo_NB_lm <- lm(all_rich_dist_df_wo_NB[,3]~all_rich_dist_df_wo_NB[,2])
allrich_wo_NB_lm_sum <- summary(allrich_wo_NB_lm)
##Reduced data frame
######################################################################
########################## Linear Models  ############################
######################################################################
###now calculate regressions - linear
allrich_wo_NB_lm <- lm(all_rich_dist_df_wo_NB[,3]~all_rich_dist_df_wo_NB[,2])
allrich_wo_NB_lm_sum <- summary(allrich_wo_NB_lm)
##Reduced data frame
allrich_red_lm <- lm(all_rich_dist_df_wo_NB_red[,3]~all_rich_dist_df_wo_NB_red[,2])
allrich_red_lm_sum <- summary(allrich_red_lm)
##create r2 and p for full df
linear_allrich_dist_wo_NB_r2 <- allrich_wo_NB_lm_sum$adj.r.squared
linear_allrich_dist_wo_NB_coef <- allrich_wo_NB_lm_sum$coefficients
linear_allrich_dist_wo_NB_pvalue <- linear_allrich_dist_wo_NB_coef[2,4]
linear_allrich_dist_wo_NB_rp <- vector('expression',2)
linear_allrich_dist_wo_NB_rp[1] <- substitute(expression(italic(R)^2 == MYVALUE),
list(MYVALUE = format(linear_allrich_dist_wo_NB_r2,dig=3)))[2]
linear_allrich_dist_wo_NB_rp[2] <- substitute(expression(italic(p) == MYOTHERVALUE),
list(MYOTHERVALUE = format(linear_allrich_dist_wo_NB_pvalue, digits = 2)))[2]
##create r2 and p for reduced df
linear_allrich_dist_wo_NB_red_r2 <- allrich_red_lm_sum$adj.r.squared
linear_allrich_dist_wo_NB_red_coef <- allrich_red_lm_sum$coefficients
linear_allrich_dist_wo_NB_red_pvalue <- linear_allrich_dist_wo_NB_red_coef[2,4]
linear_allrich_dist_wo_NB_red_rp <- vector('expression',2)
linear_allrich_dist_wo_NB_red_rp[1] <- substitute(expression(italic(R)^2 == MYVALUE),
list(MYVALUE = format(linear_allrich_dist_wo_NB_red_r2,dig=3)))[2]
linear_allrich_dist_wo_NB_red_rp[2] <- substitute(expression(italic(p) == MYOTHERVALUE),
list(MYOTHERVALUE = format(linear_allrich_dist_wo_NB_red_pvalue, digits = 2)))[2]
plot(all_rich_dist_df_wo_NB[,3]~all_rich_dist_df_wo_NB[,2],
col = as.character(all_rich_dist_df_wo_NB[,4]), pch = 17,
ylab = "Allelic Richness", xlab = "Distance to Range Edge (km)",
cex = (butternut_24pop_poppr[7:24,2]/50), ylim = c(5,10), xlim = c(0,600),
main = "Allelic Richness Compared with Distance to Range Edge (km)")
text(all_rich_dist_df_wo_NB[,2]~all_rich_dist_df_wo_NB[,1],
labels = rownames(all_rich_dist_df), cex = 0.8, pos = 1)
plot(all_rich_dist_df_wo_NB[,3]~all_rich_dist_df_wo_NB[,2],
col = as.character(all_rich_dist_df_wo_NB[,4]), pch = 17,
ylab = "Allelic Richness", xlab = "Distance to Range Edge (km)",
cex = (butternut_24pop_poppr[7:24,2]/50), ylim = c(5,10), xlim = c(0,600),
main = "Allelic Richness Compared with Distance to Range Edge (km)")
text(all_rich_dist_df_wo_NB[,2]~all_rich_dist_df_wo_NB[,1],
labels = rownames(all_rich_dist_df), cex = 0.8, pos = 1)
text(all_rich_dist_df_wo_NB[,3]~all_rich_dist_df_wo_NB[,2],
labels = rownames(all_rich_dist_df_wo_NB), cex = 0.8, pos = 1)
plot(all_rich_dist_df_wo_NB[,3]~all_rich_dist_df_wo_NB[,2],
col = as.character(all_rich_dist_df_wo_NB[,4]), pch = 17,
ylab = "Allelic Richness", xlab = "Distance to Range Edge (km)",
cex = (butternut_24pop_poppr[7:24,2]/50), ylim = c(5,10), xlim = c(0,600),
main = "Allelic Richness Compared with Distance to Range Edge (km)")
text(all_rich_dist_df_wo_NB[,3]~all_rich_dist_df_wo_NB[,2],
labels = all_rich_dist_df_wo_NB[,1], cex = 0.8, pos = 1)
abline(allrich_wo_NB_lm, col = "dodgerblue4")
abline(allrich_red_lm, col = "darkorchid")
##legends
legend('topleft', legend = linear_allrich_dist_wo_NB_rp, pch = 17, col = "dodgerblue4",
title = "Regression with WI wo NB",
bty = 'n', border = "black", pt.cex = 1, cex = 0.8)
legend('bottomleft', legend = linear_allrich_dist_wo_NB_red_rp, pch = 17,
col = "darkorchid", title = "Regression without WI wo NB",
bty = 'n', border = "black", pt.cex = 1, cex = 0.8)
legend('bottom', legend = c("Ontario", "Quebec", "United States"),
pch = 17, col = c("firebrick4", "lightsalmon","dodgerblue"))
##Allelic Richness Distance
pdf("genetic_analyses_results\\linear_allrich_dist_woNB.pdf", width = 8, height = 6)
plot(all_rich_dist_df_wo_NB[,3]~all_rich_dist_df_wo_NB[,2],
col = as.character(all_rich_dist_df_wo_NB[,4]), pch = 17,
ylab = "Allelic Richness", xlab = "Distance to Range Edge (km)",
cex = (butternut_24pop_poppr[7:24,2]/50), ylim = c(5,10), xlim = c(0,600),
main = "Allelic Richness Compared with Distance to Range Edge (km)")
text(all_rich_dist_df_wo_NB[,3]~all_rich_dist_df_wo_NB[,2],
labels = all_rich_dist_df_wo_NB[,1], cex = 0.8, pos = 1)
abline(allrich_wo_NB_lm, col = "dodgerblue4")
abline(allrich_red_lm, col = "darkorchid")
##legends
legend('topleft', legend = linear_allrich_dist_wo_NB_rp, pch = 17, col = "dodgerblue4",
title = "Regression with WI wo NB",
bty = 'n', border = "black", pt.cex = 1, cex = 0.8)
legend('bottomleft', legend = linear_allrich_dist_wo_NB_red_rp, pch = 17,
col = "darkorchid", title = "Regression without WI wo NB",
bty = 'n', border = "black", pt.cex = 1, cex = 0.8)
legend('bottom', legend = c("Ontario", "Quebec", "United States"),
pch = 17, col = c("firebrick4", "lightsalmon","dodgerblue"))
dev.off()
###write out data frame with p values and r2
##create data frame
dist_edge_allrich_woNB_df <- matrix(nrow = 2, ncol = 2)
##insert values
dist_edge_allrich_woNB_df[1,] <- c(linear_allrich_dist_wo_NB_pvalue,linear_allrich_dist_wo_NB_r2)
dist_edge_allrich_woNB_df[2,] <- c(linear_allrich_dist_wo_NB_red_pvalue, linear_allrich_dist_wo_NB_red_r2)
##name columns and row names
rownames(dist_edge_woNB_df) <- c("Distance to Edge Allelic Richness without NB",
"Distance to Edge Allelic Richness without NB and without WI")
colnames(dist_edge_woNB_df) <- c("P-value","R2")
##name columns and row names
rownames(dist_edge_allrich_woNB_df) <- c("Distance to Edge Allelic Richness without NB",
"Distance to Edge Allelic Richness without NB and without WI")
colnames(dist_edge_allrich_woNB_df) <- c("P-value","R2")
##write out csv
write.csv(dist_edge_allrich_woNB_df, "genetic_analyses_results\\dist_edge_allrich_woNB_df.csv")
#####################################
############ Directories ############
#####################################
butternut_drive <- "C:\\Users\\eschumacher\\Documents\\GitHub\\butternut"
######################################################
#################### Load Files  #####################
######################################################
##set working directory
setwd(butternut_drive)
##load current working reorganized genepop file
butternutgen_reorg <- read.genepop("data_files\\after_reorg\\reorg_gen_24pop.gen", ncode = 3)
##load relatedness file to name individuals
reorg_relatedness <- read.csv("data_files\\after_reorg\\reorg_relatedness.csv")
###Name the reorg file
rownames(butternutgen_reorg@tab) <- reorg_relatedness$Ind
##create population name file
butternut_24pop_names <- unique(reorg_relatedness$Pop)
##Name levels
levels(butternutgen_reorg@pop) <- butternut_24pop_names
##generate a poppr document
butternut_24pop_poppr <- poppr(butternutgen_reorg)
##load in allelic richness and distance edge document
allrich_dist_edge_df <- read.csv("genetic_analyses_results\\hexp_dist_edge_df.csv")
##load in allelic richness and distance edge document
hexp_dist_edge_df <- read.csv("genetic_analyses_results\\hexp_dist_edge_df.csv")
hexp_dist_edge_df
##############################################################################
######## Run Analyses and Create DF of Just Ontario Quebec and US  ###########
##############################################################################
##remove New Brunswick and create DFs
hexp_dist_edge_df_woNB <- hexp_dist_edge_df[-c(1:6),]
hexp_dist_edge_df_woNB
##without wisconsin populations
hexp_dist_edge_df_woNB_red <- hexp_dist_edge_df_woNB[-c(10,16:17),]
######################################################################
########################## Linear Models  ############################
######################################################################
###now calculate regressions - linear
hexp_woNB_lm <- lm(hexp_dist_edge_df_woNB[,3]~hexp_dist_edge_df_woNB[,2])
hexp_woNB_lm_sum <- summary(hexp_woNB_lm)
hexp_dist_edge_df_woNB_red
##Reduced data frame
hexp_woNB_red_lm <- lm(hexp_dist_edge_df_woNB_red[,3]~hexp_dist_edge_df_woNB_red[,2])
hexp_woNB_red_lm_sum <- summary(hexp_woNB_red_lm)
######################################################################
########################## Linear Models  ############################
######################################################################
###now calculate regressions - linear
hexp_woNB_lm <- lm(hexp_dist_edge_df_woNB[,3]~hexp_dist_edge_df_woNB[,2])
hexp_woNB_lm_sum <- summary(hexp_woNB_lm)
##Reduced data frame
hexp_woNB_red_lm <- lm(hexp_dist_edge_df_woNB_red[,3]~hexp_dist_edge_df_woNB_red[,2])
hexp_woNB_red_lm_sum <- summary(hexp_woNB_red_lm)
##create r2 and p for full df
hexp_dist_edge_woNB_r2 <- hexp_woNB_lm_sum$adj.r.squared
hexp_dist_edge_woNB_coef <- hexp_woNB_lm_sum$coefficients
hexp_dist_edge_woNB_pvalue <- hexp_dist_edge_woNB_coef[2,4]
hexp_dist_edge_woNB_rp <- vector('expression',2)
hexp_dist_edge_woNB_rp[1] <- substitute(expression(italic(R)^2 == MYVALUE),
list(MYVALUE = format(hexp_dist_edge_woNB_r2,dig=3)))[2]
hexp_dist_edge_woNB_rp[2] <- substitute(expression(italic(p) == MYOTHERVALUE),
list(MYOTHERVALUE = format(hexp_dist_edge_woNB_pvalue, digits = 2)))[2]
##create r2 and p for reduced df
hexp_dist_edge_woNB_red_r2 <- hexp_woNB_red_lm_sum$adj.r.squared
hexp_dist_edge_woNB_red_coef <- hexp_woNB_red_lm_sum$coefficients
hexp_dist_edge_woNB_red_pvalue <- hexp_dist_edge_woNB_red_coef[2,4]
hexp_dist_edge_woNB_red_rp <- vector('expression',2)
hexp_dist_edge_woNB_red_rp[1] <- substitute(expression(italic(R)^2 == MYVALUE),
list(MYVALUE = format(hexp_dist_edge_woNB_red_r2,dig=3)))[2]
hexp_dist_edge_woNB_red_rp[2] <- substitute(expression(italic(p) == MYOTHERVALUE),
list(MYOTHERVALUE = format(hexp_dist_edge_woNB_red_pvalue, digits = 2)))[2]
plot(hexp_dist_edge_df_woNB[,3]~hexp_dist_edge_df_woNB[,2],
col = as.character(hexp_dist_edge_df_woNB[,4]), pch = 17,
ylab = "Allelic Richness", xlab = "Distance to Range Edge (km)",
cex = (butternut_24pop_poppr[7:24,2]/50), ylim = c(5,10), xlim = c(0,600),
main = "Allelic Richness Compared with Distance to Range Edge (km)")
butternut_24pop_poppr
plot(hexp_dist_edge_df_woNB[,3]~hexp_dist_edge_df_woNB[,2],
col = as.character(hexp_dist_edge_df_woNB[,4]), pch = 17,
ylab = "Expected Heterozygosity", xlab = "Distance to Range Edge (km)",
cex = (butternut_24pop_poppr[7:24,2]/50), ylim = c(5,10), xlim = c(0.74,0.86),
main = "Expected Heterozygosity Compared with Distance to Range Edge (km)")
plot(hexp_dist_edge_df_woNB[,3]~hexp_dist_edge_df_woNB[,2])
plot(hexp_dist_edge_df_woNB[,3]~hexp_dist_edge_df_woNB[,2],
col = as.character(hexp_dist_edge_df_woNB[,4]), pch = 17,
ylab = "Expected Heterozygosity", xlab = "Distance to Range Edge (km)",
cex = (butternut_24pop_poppr[7:24,2]/50), ylim = c(0.74,0.86), xlim = c(0,600),
main = "Expected Heterozygosity Compared with Distance to Range Edge (km)")
plot(hexp_dist_edge_df_woNB[,3]~hexp_dist_edge_df_woNB[,2],
col = as.character(hexp_dist_edge_df_woNB[,4]), pch = 17,
ylab = "Expected Heterozygosity", xlab = "Distance to Range Edge (km)",
cex = (butternut_24pop_poppr[7:24,2]/50), ylim = c(0.74,0.89), xlim = c(0,600),
main = "Expected Heterozygosity Compared with Distance to Range Edge (km)")
text(all_rich_dist_df_wo_NB[,3]~all_rich_dist_df_wo_NB[,2],
labels = all_rich_dist_df_wo_NB[,1], cex = 0.8, pos = 1)
plot(hexp_dist_edge_df_woNB[,3]~hexp_dist_edge_df_woNB[,2],
col = as.character(hexp_dist_edge_df_woNB[,4]), pch = 17,
ylab = "Expected Heterozygosity", xlab = "Distance to Range Edge (km)",
cex = (butternut_24pop_poppr[7:24,2]/50), ylim = c(0.74,0.89), xlim = c(0,600),
main = "Expected Heterozygosity Compared with Distance to Range Edge (km)")
text(hexp_dist_edge_df_woNB[,3]~hexp_dist_edge_df_woNB[,2],
labels = hexp_dist_edge_df_woNB[,1], cex = 0.8, pos = 1)
abline(hexp_woNB_lm, col = "dodgerblue4")
abline(hexp_woNB_red_lm, col = "darkorchid")
##legends
legend('topleft', legend = hexp_dist_edge_woNB_rp, pch = 17, col = "dodgerblue4",
title = "Regression with WI wo NB",
bty = 'n', border = "black", pt.cex = 1, cex = 0.8)
legend('bottomleft', legend = hexp_dist_edge_woNB_red_rp, pch = 17,
col = "darkorchid", title = "Regression without WI wo NB",
bty = 'n', border = "black", pt.cex = 1, cex = 0.8)
legend('bottom', legend = c("Ontario", "Quebec", "United States"),
pch = 17, col = c("firebrick4", "lightsalmon","dodgerblue"))
plot(hexp_dist_edge_df_woNB[,3]~hexp_dist_edge_df_woNB[,2],
col = as.character(hexp_dist_edge_df_woNB[,4]), pch = 17,
ylab = "Expected Heterozygosity", xlab = "Distance to Range Edge (km)",
cex = (butternut_24pop_poppr[7:24,2]/50), ylim = c(0.74,0.89), xlim = c(0,600),
main = "Expected Heterozygosity Compared with Distance to Range Edge (km)")
text(hexp_dist_edge_df_woNB[,3]~hexp_dist_edge_df_woNB[,2],
labels = hexp_dist_edge_df_woNB[,1], cex = 0.8, pos = 1)
abline(hexp_woNB_lm, col = "dodgerblue4")
abline(hexp_woNB_red_lm, col = "darkorchid")
##legends
legend('topleft', legend = hexp_dist_edge_woNB_rp, pch = 17, col = "dodgerblue4",
title = "Regression with WI wo NB",
bty = 'n', border = "black", pt.cex = 1, cex = 0.8)
legend('bottomleft', legend = hexp_dist_edge_woNB_red_rp, pch = 17,
col = "darkorchid", title = "Regression without WI wo NB",
bty = 'n', border = "black", pt.cex = 1, cex = 0.8)
legend('bottomright', legend = c("Ontario", "Quebec", "United States"),
pch = 17, col = c("firebrick4", "lightsalmon","dodgerblue"))
##Allelic Richness Distance
pdf("genetic_analyses_results\\linear_hexp_dist_woNB.pdf", width = 8, height = 6)
plot(hexp_dist_edge_df_woNB[,3]~hexp_dist_edge_df_woNB[,2],
col = as.character(hexp_dist_edge_df_woNB[,4]), pch = 17,
ylab = "Expected Heterozygosity", xlab = "Distance to Range Edge (km)",
cex = (butternut_24pop_poppr[7:24,2]/50), ylim = c(0.74,0.89), xlim = c(0,600),
main = "Expected Heterozygosity Compared with Distance to Range Edge (km)")
text(hexp_dist_edge_df_woNB[,3]~hexp_dist_edge_df_woNB[,2],
labels = hexp_dist_edge_df_woNB[,1], cex = 0.8, pos = 1)
abline(hexp_woNB_lm, col = "dodgerblue4")
abline(hexp_woNB_red_lm, col = "darkorchid")
##legends
legend('topleft', legend = hexp_dist_edge_woNB_rp, pch = 17, col = "dodgerblue4",
title = "Regression with WI wo NB",
bty = 'n', border = "black", pt.cex = 1, cex = 0.8)
legend('bottomleft', legend = hexp_dist_edge_woNB_red_rp, pch = 17,
col = "darkorchid", title = "Regression without WI wo NB",
bty = 'n', border = "black", pt.cex = 1, cex = 0.8)
legend('bottomright', legend = c("Ontario", "Quebec", "United States"),
pch = 17, col = c("firebrick4", "lightsalmon","dodgerblue"))
dev.off()
##insert values
dist_edge_hexp_woNB_df[1,] <- c(hexp_dist_edge_woNB_pvalue,hexp_dist_edge_woNB_r2)
dist_edge_hexp_woNB_df[2,] <- c(hexp_dist_edge_woNB_red_pvalue, hexp_dist_edge_woNB_red_r2)
###write out data frame with p values and r2
##create data frame
dist_edge_hexp_woNB_df <- matrix(nrow = 2, ncol = 2)
##insert values
dist_edge_hexp_woNB_df[1,] <- c(hexp_dist_edge_woNB_pvalue,hexp_dist_edge_woNB_r2)
dist_edge_hexp_woNB_df[2,] <- c(hexp_dist_edge_woNB_red_pvalue, hexp_dist_edge_woNB_red_r2)
##name columns and row names
rownames(dist_edge_allrich_woNB_df) <- c("Distance to Edge Expected Heterozygosity without NB",
"Distance to Edge Expected Heterozygosity without NB and without WI")
colnames(dist_edge_allrich_woNB_df) <- c("P-value","R2")
##name columns and row names
rownames(dist_edge_hexp_woNB_df) <- c("Distance to Edge Expected Heterozygosity without NB",
"Distance to Edge Expected Heterozygosity without NB and without WI")
colnames(dist_edge_hexp_woNB_df) <- c("P-value","R2")
##write out csv
write.csv(dist_edge_hexp_woNB_df, "genetic_analyses_results\\dist_edge_hexp_woNB_df.csv")
