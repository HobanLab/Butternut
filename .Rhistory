library(adegenet)
##############################################################
#################### Load Files  #############################
##############################################################
##set working directory
setwd(butternut_drive)
#####################################
############ Directories ############
#####################################
butternut_drive <- "C:\\Users\\eschumacher\\Documents\\GitHub\\butternut"
##############################################################
#################### Load Files  #############################
##############################################################
##set working directory
setwd(butternut_drive)
##load current working reorganized genepop file
butternutgen_reorg <- read.genepop("data_files\\after_reorg\\reorg_gen_24pop.gen", ncode = 3)
##load relatedness file to name individuals
reorg_relatedness <- read.csv("data_files\\after_reorg\\reorg_relatedness.csv")
##name individuals in genind file
rownames(butternutgen_reorg@tab) <- reorg_relatedness$Ind
##load in mean longitude and latitude by population
allrich_lat_df <- read.csv("genetic_analyses_results\\all_rich_lat_df.csv")
View(allrich_lat_df)
##get population names
butternut_24pop_names <- unique(reorg_relatedness$Pop)
##name populations in genind file
levels(butternutgen_reorg@pop) <- butternut_24pop_names
##create butternut poppr
butternut_poppr <- poppr(butternutgen_reorg)
library(poppr)
##create butternut poppr document
butternut_poppr <- poppr(butternutgen_reorg)
library(geosphere)
#####################################
############ Directories ############
#####################################
butternut_drive <- "C:\\Users\\eschumacher\\Documents\\GitHub\\butternut"
##########################################################
####################### Load Files  ##########################
##############################################################
setwd(butternut_drive)
##load in butternut buffer shapefile
butternut_buffer <- shapefile("data_files\\geographic_files\\butternut_buffer")
library(rgdal)
#####################################
############ Directories ############
#####################################
butternut_drive <- "C:\\Users\\eschumacher\\Documents\\GitHub\\butternut"
##########################################################
####################### Load Files  ##########################
##############################################################
setwd(butternut_drive)
##load in butternut buffer shapefile
butternut_buffer <- shapefile("data_files\\geographic_files\\butternut_buffer")
library(rgeos)
library(raster)
##load in butternut buffer shapefile
butternut_buffer <- shapefile("data_files\\geographic_files\\butternut_buffer")
##load mean longitude and latitude document for all populations
butternut_coord_df <- read.csv("data_files\\geographic_files\\butternut_coord_df.csv")
butternut_coord_df
##load relatedness file to name individuals
reorg_relatedness <- read.csv("data_files\\after_reorg\\reorg_relatedness.csv")
##create list of the 24 populations
butternut_24pop_names <- unique(reorg_relatedness$Pop)
##get butternut 24 population names
butternut_coord_df[,1] <- butternut_24pop_names
butternut_coord_df
####################################################
############# Calculate distance to edge ###########
####################################################
##name columns
colnames(butternut_coord_df) <- c("Pop","Longitude","Latitude","Col")
##make spatial
coordinates(butternut_coord_df) <- c('Longitude', 'Latitude')
proj4string(butternut_coord_df) <- CRS("+proj=longlat +ellps=WGS84 +datum=WGS84")
##change proj4string
butternut_buffer_WGS84 <- spTransform(butternut_buffer, CRS("+proj=longlat +ellps=WGS84 +datum=WGS84"))
#####Calculate distance to edge
dist_to_edge <- dist2Line(butternut_coord_df, butternut_buffer_WGS84, distfun = distGeo)
dist_to_edge
butternut_coord_df[,1]
data.frame(butternut_coord_df)
##put butternut coord df back into a data frame
butternut_lonlat_df <- data.frame(butternut_coord_df)
butternut_lonlat_df[,1:3]
####Now combine into a data frame, divide by 1000 to get into km
butternut_dist <- data.frame(cbind(butternut_lonlat_df[,1:3], (dist_to_edge[,1]/1000)))
####Now combine into a data frame, divide by 1000 to get into km
butternut_dist_df <- data.frame(cbind(butternut_lonlat_df[,1:3], (dist_to_edge[,1]/1000)))
butternut_dist_df
####Now combine into a data frame, divide by 1000 to get into km
butternut_dist_df <- data.frame(cbind(butternut_lonlat_df[,1:3], (dist_to_edge[,1]/1000)))
##add column names
colnames(butternut_dist_df) <- c("MeanLong", "MeanLat", "Dist_To_Edge")
butternut_dist_df
##add column names
colnames(butternut_dist_df) <- c("Pop","MeanLong", "MeanLat", "Dist_To_Edge")
butternut_dist_df
##add a column for colors by location
butternut_dist_df$Col <- "NA"
##write out distance to edge csv
write.csv(butternut_dist_df, "data_files\\geographic_files\\butternut_dist_df.csv")
